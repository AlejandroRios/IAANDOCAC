function [a0 v0 pt0 Tt0 pt2 Tt2 pt13 Tt13 pt15 Tt15 m15 T15 p15 pt3 Tt3 pt4 f pt5 Tt5 Tt9 pt9 m9 p9 T9 v9 A9Rm0 v9eff nspthr  nth np no TSFC fo alphat]=mxturbofan(T0,m0,p0,prd,prf,nf,prfd,prc,nc,Tt4,LHV,prb,nb,et,nm,m5,prmxf,Tt7,LHVafb,prafb,nafb,prn,g,cp,gaf,cpaf,gafb,cpafb,R,Raf,Rafb,expr)
[v0 pt0 Tt0]=inlet(R,g,T0,m0,p0,cp);
a0=v0/m0;
[pt2 Tt2]=diffuser(prd,pt0,Tt0);
[pt13 Tt13]=fan(pt2,prf,g,nf,Tt2);
tauf=Tt13/Tt2;
Tt15=Tt13;
pt15=pt13*prfd;
[pt3 Tt3]=compressor(prc,pt2,g,nc,Tt2);
[pt4 f]=burner(prb,pt3,Tt3,cpaf,Tt4,cp,LHV,nb);
prt=((prfd*prf)/(prb*prc));
taut=prt^(((gaf-1)/gaf)*et);
Tt5=Tt4*taut;
pt5=pt4*prt;
T5=Tt5/(1+(((gaf-1)*(m5^2))/2));
a5=(((gaf*Raf*T5)^0.5));
alpha=((nm*(1+f)*(cpaf/cp)*(Tt4-Tt5))-(Tt3-Tt2))/(Tt13-Tt2);
alphat=((nm*(1+f)*(cpaf/cp)*(Tt4-Tt5))-(Tt3-Tt2))/(Tt13-Tt2);
ht6m=((((1+f)*taut*cpaf*Tt4)+(alpha*tauf*cp*Tt0))/(1+alpha+f));
cp6m=((((1+f)*cpaf)+(alpha*cp))/(1+alpha+f));
g6m=(((1+f)*cpaf)+(alpha*cp))/(((1+f)*(cpaf/gaf))+(alpha*(cp/g)));
m15=((((((1+((gaf-1)*0.5*(m5^2)))^(gaf/(gaf-1)))^((g-1)/g))-1)*(2/(g-1)))^0.5);
T15=Tt15/(1+(((g-1)*(m15^2))/2));
p15=pt15/((Tt15/T15)^(g/(g-1)));
a15=(((g*R*T15)^0.5));
p5=pt5/((Tt5/T5)^(gaf/(gaf-1)));
A15RA5=((alpha/(1+f))*(gaf/g)*(a15/a5)*(m5/m15));
c1=(((1+(gaf*(m5^2)))+(A15RA5*(1+(g*(m15^2)))))/(1+A15RA5));
c2=((((gaf/g6m)*(m5/a5))+((g/g6m)*((m15*(A15RA5))/a15)))*((((g6m-1)*ht6m)^0.5)/(1+A15RA5)));
c=((c1/c2)^2);
m6m=(((c-(2*g6m)- (((c-(2*g6m))^2)-(4*((g6m^2)-(c*(g6m-1)*0.5))))^0.5 )/(2*(g6m^2)-(c*(g6m-1))))^0.5);
p6m=p5*(c1/(1+g6m*(m6m^2)));
pt6mi=((((1+(((g6m-1)*(m6m^2))/2))^(g6m/(g6m-1)))*p6m));
prmi=pt6mi/pt5;
prm=prmi*prmxf;
pt6m=pt6mi*prmxf;
pt7=(pt6m*prafb);
fafb=(((cp6m*Tt7-ht6m))/(((nafb*LHVafb))-Tt7*cp6m));
pt9=pt7*prn;
Tt9=Tt7;
if (pt7/p0)<(((gaf+1)/2)^(gaf/(gaf-1)))
    p9=p0;
    m9=(((((pt9/p9)^((gafb-1)/(gafb)))-1)*(2/(gafb-1)))^0.5);
    T9=(Tt9/(1+(0.5*(gafb-1)*((m9)^2))));
    v9=((2*cpafb*(Tt9-T9))^0.5);
    A9Rm0=((1+fafb+f)*((Rafb*T9)/(p9*v9)));
    v9eff=(v9+(A9Rm0*((p9-p0)/(1+f+fafb))));
    nspthr=((((1+alpha+f+(fafb*(1+alpha+f)))/(1+alpha))*(v9eff/a0))-m0);
    TSFC=( ((f+(fafb*(1+alpha+f)))/((1+alpha)*a0)) *10^6)/nspthr;
    nth=((((1+alpha+f+(fafb*(1+alpha+f)))*((v9eff)^2))-((1+alpha)*(v0^2)))/(2*((f*LHV)+((fafb*(1+alpha+f))*LHVafb))));
    np=(2*nspthr*v0)/(((1+alpha+f+(fafb*(1+alpha+f)))/((1+alpha)*a0)*(v9eff^2))-((v0^2)/a0));
    no=np*nth;
    fo=f+fafb;
else p9=p0*expr;
    m9=(((((pt9/p9)^((gafb-1)/(gafb)))-1)*(2/(gafb-1)))^0.5);
    T9=(Tt9/(1+(0.5*(gafb-1)*((m9)^2))));
    v9=((2*cpafb*(Tt9-T9))^0.5);
    A9Rm0=((1+fafb+f)*((Rafb*T9)/(p9*v9)));
    v9eff=(v9+(A9Rm0*((p9-p0)/(1+f+fafb))));
    nspthr=((((1+alpha+f+(fafb*(1+alpha+f)))/(1+alpha))*(v9eff/a0))-m0);
    TSFC=( ((f+(fafb*(1+alpha+f)))/((1+alpha)*a0)) *10^6)/nspthr;
    nth=((((1+alpha+f+(fafb*(1+alpha+f)))*((v9eff)^2))-((1+alpha)*(v0^2)))/(2*((f*LHV)+((fafb*(1+alpha+f))*LHVafb))));
    np=(2*nspthr*v0)/(((1+alpha+f+(fafb*(1+alpha+f)))/((1+alpha)*a0)*(v9eff^2))-((v0^2)/a0));
    no=np*nth;
    fo=f+fafb;
end